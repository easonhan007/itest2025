---
weight: 0
title: 挑战超低成本的NAS
date: '2025-06-17T17:29:15+08:00'
lastmod: '2025-06-17T17:29:15+08:00'
draft: false
author: 乙醇
authorLink: https://github.com/easonhan007
images: []
resources:
- name: featured-image
  src: https://images.unsplash.com/photo-1431887773042-803ed52bed26?w=300
tags: []
categories:
- 博客合集
lightgallery: true
toc:
  auto: false
---



最近发现视频和照片渐渐多了起来，我的机器储存空间有限，每次用移动硬盘去拷贝备份其实蛮麻烦的，所以想到是不是要搭建一套家用的NAS。

那什么是NAS呢？

我百度了一下，NAS（Network Attached Storage：网络附属存储）按字面简单说就是连接在网络上，具备资料存储功能的装置，因此也称为“网络存储器”。它是一种专用数据存储服务器。它以数据为中心，将存储设备与服务器彻底分离，集中管理数据，从而释放带宽、提高性能、降低总拥有成本、保护投资。其成本远远低于使用服务器存储，而效率却远远高于后者。目前国际著名的NAS企业有Netapp、EMC、OUO等。

所以NAS是一个网络储存设备，在家里搭建NAS其实就是在家里搭建一个百度网盘。

心动不如行动，先看一下这一套弄下来要多少钱吧。

打开某东，找了一款相对便宜的nas设备，618的价格是1899，不带系统盘和存储盘。所以加上128G的系统盘和1块2T的3.5寸硬盘，大概要400多块，总的成本是2300多，这样看来还是比较贵的。

那么有没有比较便宜的选择呢？

我咨询了一下某资深的各种电脑设备折腾家，他告诉我他家里就有一台NAS，他的解决方案是一台台式机，装centos，接一个raid5阵列，然后各种系统(win/mac/linux/ios)都用samba去访问储存资源。这一番话让我醍醐灌顶，原来nas并不需要专用设备以及装专用系统，思路一打开，后面的解决方案就很容易确定了。

我先整理了一下我的需求，需求决定实现，所以要先捋清楚，我大概有下面几个需求。

* 存储。我有一些文件/图片/视频需要找个地方存起来，这是备份的需求，因为副本是每天都存在的，所以这是一个日常存储需求；
* 从各个设备上看照片。没事我会翻一下照片，这是低频需求；
* 看视频/电影。这个是低频需求，因为基本没啥时间看；
* 走线/组网简单。我家里走线非常困难，所以NAS要支持无线传输;

所以综合看来，我的需求其实简单而且要求不高，那么我的NAS实现其实只要满足下面几个点就好了

* 稳定。长期不关机，所以系统用linux最好，我有一台云服务器自从启动到现在就没有关机或者重启过，几年了，非常稳定；
* 有samba就够，samba基本上支持所有主流的操作系统，而且搭建非常简单，省时省力;
* 功耗低。因为要常年不关机，所以电费的支出应该越低越好；
* 支持无线，不走线的方案才不是老婆见打的方案；

所以最后我选择的是低功耗机器+linux+samba的方案。

### 硬件篇

有了方案，那么就要选择合适的硬件了。

折腾家向我推荐了一款机器，是个mini主机，用的是笔记本主板，带无线，没有风扇，全靠铝制机身散热，某宝看了报价，32G系统盘+4G内存+cpu赛扬N3150的配置大概是810块，尽管成本还是有点高，买来会给贫困的家庭雪上加霜，但想到3150的cpu功率只有4w，长期使用的话成本其实可控，而且没有风扇的噪音，咬牙买了吧。

机器大概长这个样子的。

正面面板4个USB3,2个USB2接口，双千兆网口，双HDMI接口，带无线网卡，小巧，跟家里的路由器差不多大，安静，毕竟没风扇，唯一的问题是机身整体散热，所以要放在通风的地方，不能藏起来让老婆不发现，但搭建低成本NAS本来就是一个挑战，挑战总是有代价的。

再去某东买了块2.5寸的2T硬盘，500块，稳稳的塞进小主机里，这样总价1300块，硬件方面就准备完毕了。

其实也考虑过带风扇的小机箱准系统解决方案，如果去某宝捡垃圾的话(就是买国外淘汰的洋垃圾)，联想准系统(只有机箱主板没有cpu内存硬盘)大概300多，加上cpu内存硬盘，可能总价1000之内是可以搞定的，不过捡垃圾毕竟有风险的，而且折腾起来也花时间，万一翻车点不亮就麻烦了，性价比太低，所以就没有考虑这个方案了。


### 软件篇

下面就是装系统了，ubuntu，我所欲也，centos，亦我所欲也;二者不可得兼， 舍centos而取ubuntu掌者也。其实这两个大众化的分发版本随便装一个就好了，因为ubuntu的live ubs教程更多，所以我选择安装ubuntu的server版本，也就是没有UI界面的版本。

### 装机篇

我从ubuntu官网下了个服务器版本的iso，然后通过教程一步一步做了个装系统的u盘，大概晚上10点半左右的时候开始安装server版本，大概11点就装完了。

装完以后发现server版本并没有带无线网络的服务，所以需要上网去下载，然而我并不能查有线上网，所以死循环了，翻车了。

没办法，只能下载个desktop版本，也就是有UI的版本装上，这个版本是自带无线网卡服务的，安装过程中无线网就配置好了。不过desktop版本安装非常慢，折腾好之后，安装ssh服务，然后禁用ui界面，重启进入纯server模式，搞完已经是12点半了，太累了，明天再战。

第二天晚上花半小时装好samba，迫不及待的拷了一些文件测速，nas的写入速度大概是2m/s，比百度网盘快不了多少，分析了一下原因，可能是因为走的无线网络，丢包率高带宽有限，所以2m应该是极限速度了，完美翻车。

### 调优篇

2m的上传下载速度其实跟百度云是差不多了，不过按照其他人的说法，这个速度是有上升的空间的。

首先能想到的就是组网方式的调优，要想办法把nas用有线连接到路由器上面去，这个基本很难，但可以挑战一下。

翻出一条陈年的网线，战战兢兢的把路由器从弱电箱里搬出来放在桌子上，最后让nas跟它肩并肩，一根网线两相连，再来试试速度，果然4M/s，比之前提高了2倍。

后面就是samba的配置调优，这个不急，有时候再搞，4m的速度已经超过了百度云，家用凑合吧，不过桌子上现在摆了2尊神器，我提醒自己一定要做好老婆的情绪管理。

### 外网访问篇

出门在外如果想访问nas那怎么办呢？

其实我的路由器是有NAT功能的，只要有公网ip就可以连接了，不过运营商基本把nat的端口给封完了，所以在路由器上配置基本就没有用了。

同事告诉我一个神器，是某品牌的一个盒子，接上去就可以从外网打洞/vpn访问家里的网络了。

花98买了一台，傻瓜式接入和配置，现在手机上直接vpn回家里，访问mas上的小文件基本上没啥问题了。

不过这个盒子有自己的局限，只支持2台外网设备，外网下载速度最多才250k，每个月只有1g流量，也就是玩一下，保留了外网访问的能力而已。

### 总结

这次低成本nas+外网访问的挑战算是告一段落了。

总成本大概是1400元左右，花费了大概6个小时的时间。

总之组网加各种配置是挺有意思的，但是装机啥的因为没有啥技术含量，就显得挺无聊了。

简单总结一下，这套方案也就是能用够用，成本不算特别低，不过稳定性还不错，功耗也比较低，长期使用成本可控。

下次看看再折腾点啥，来点更有意思的挑战吧。












原始封面

![课程图片](https://images.unsplash.com/photo-1431887773042-803ed52bed26?w=300)

